(()=>{const DATA_URL='./data/providers.sample.json';const state={cat:'sports',sort:'첫입금 보너스 높은순',grid:false,data:[]};const el={cards:()=>document.getElementById('cards'),sort:()=>document.getElementById('sortSelect'),view:()=>document.getElementById('viewToggle')};const sorters={'첫입금 보너스 높은순':p=>-(p.firstDeposit||0),'첫충전 보너스 높은순':p=>-(p.reload||0),'재충전 보너스 높은순':p=>-(p.reload||0),'올인 보너스 높은순':p=>-(p.allin||0),'당일 페이백 높은순':p=>-(p.paybackDaily||0),'주간 페이백 높은순':p=>-(p.paybackWeekly||0),'후기 평점 높은순':p=>-(p.review||0),'전체 당첨금 높은순':p=>-(p.totalPrize||0)};function badge(p){return p.arbSafe?'<span class="ml-2 text-emerald-400 text-xs border border-emerald-500/30 bg-emerald-500/10 px-2 py-0.5 rounded-full">Arb-Safe</span>':''}function card(p){return `<div class="rounded-2xl bg-stone-900 border border-stone-800 p-4 hover:border-stone-700 transition"><div class="flex items-center justify-between mb-1"><h4 class="font-semibold">${p.name}</h4><span class="text-xs text-stone-400">${p.category}</span></div><div class="text-xs text-stone-400">${p.desc||''}</div><div class="mt-3 grid grid-cols-2 gap-2 text-sm"><div class="rounded-xl border border-stone-800 p-2"><div class="text-stone-400 text-xs">첫입금</div><div class="font-semibold">${p.firstDeposit||0}%</div></div><div class="rounded-xl border border-stone-800 p-2"><div class="text-stone-400 text-xs">재충전</div><div class="font-semibold">${p.reload||0}%</div></div><div class="rounded-xl border border-stone-800 p-2"><div class="text-stone-400 text-xs">당일 페이백</div><div class="font-semibold">${p.paybackDaily||0}%</div></div><div class="rounded-xl border border-stone-800 p-2"><div class="text-stone-400 text-xs">주간 페이백</div><div class="font-semibold">${p.paybackWeekly||0}%</div></div></div><div class="mt-3 flex items-center text-sm"><span class="text-amber-400">★ ${p.review?.toFixed(1)??'0.0'}</span>${badge(p)}</div><div class="mt-3 flex gap-2"><a class="px-3 py-1.5 rounded-xl bg-emerald-600 hover:bg-emerald-500 text-white text-sm" href="#" target="_blank" rel="noopener">가입</a><a class="px-3 py-1.5 rounded-xl bg-stone-800 hover:bg-stone-700 text-sm" href="#" target="_blank" rel="noopener">자세히</a></div></div>`}function render(){const wrap=el.cards();if(!wrap) return;wrap.className = state.grid? 'grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4':'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4';const list=state.data.filter(p=>p.cat===state.cat).sort((a,b)=>{const f=sorters[state.sort]||(()=>0);return f(a)-f(b)});wrap.innerHTML=list.map(card).join('')}function initTabs(){document.querySelectorAll('.cat-tab').forEach(btn=>{btn.addEventListener('click',()=>{document.querySelectorAll('.cat-tab').forEach(b=>b.classList.remove('bg-stone-800','text-white'));btn.classList.add('bg-stone-800','text-white');state.cat=btn.dataset.cat;render();});});document.querySelector('.cat-tab[data-cat="sports"]').click()}function initSort(){el.sort().addEventListener('change',e=>{state.sort=e.target.value;render()})}function initView(){el.view().addEventListener('click',()=>{state.grid=!state.grid;el.view().textContent=state.grid?'리스트 보기':'그리드 보기';render()})}async function load(){try{const r=await fetch(DATA_URL,{cache:'no-store'});state.data=await r.json()}catch(e){state.data=[{"name":"Alpha","cat":"sports","category":"스포츠","firstDeposit":40,"reload":10,"paybackDaily":3,"paybackWeekly":7,"review":4.2,"totalPrize":120,"arbSafe":true},{"name":"Bravo","cat":"sports","category":"스포츠","firstDeposit":30,"reload":12,"paybackDaily":2,"paybackWeekly":5,"review":4.5,"totalPrize":95,"arbSafe":false},{"name":"CasinoX","cat":"casino","category":"카지노","firstDeposit":60,"reload":20,"paybackDaily":4,"paybackWeekly":8,"review":3.9,"totalPrize":150,"arbSafe":true},{"name":"SlotHub","cat":"slots","category":"슬롯","firstDeposit":70,"reload":25,"paybackDaily":5,"paybackWeekly":9,"review":4.1,"totalPrize":140,"arbSafe":true},{"name":"Delta","cat":"sports","category":"스포츠","firstDeposit":25,"reload":8,"paybackDaily":1,"paybackWeekly":4,"review":3.7,"totalPrize":80,"arbSafe":false},{"name":"Echo","cat":"casino","category":"카지노","firstDeposit":45,"reload":15,"paybackDaily":3,"paybackWeekly":6,"review":4.0,"totalPrize":110,"arbSafe":false},{"name":"Foxtrot","cat":"slots","category":"슬롯","firstDeposit":55,"reload":18,"paybackDaily":4,"paybackWeekly":7,"review":4.3,"totalPrize":130,"arbSafe":true},{"name":"Gamma","cat":"etc","category":"ETC","firstDeposit":10,"reload":5,"paybackDaily":1,"paybackWeekly":3,"review":3.2,"totalPrize":40,"arbSafe":false}];}render()}document.addEventListener('DOMContentLoaded',async()=>{initTabs();initSort();initView();await load();});})();